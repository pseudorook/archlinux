#! /bin/bash
#set -eu

dir="$(dirname "$0")"

base="${dir}/packages/base.list"
toprc="${dir}/dotfiles/toprc"
pacmanconf="/etc/pacman.conf"
function install_base {
  show_info "Installing base packages."
  sudo pacman -S $(cat ${base})
  check_fail
  show_success "Base packages installed."

  show_info "Installing toprc."
  cp -f ${toprc} ${HOME}/.toprc
  show_success "Installed toprc."

  # Customize sudo to: 
  #  - insult incorrect password attempts
  show_info "Enable sudo insults."
  sudo visudo # Consider using another sed script (DANGEROUS!!!)

  # Customize pacman to: 
  #  - color pacman output
  #  - show pacman-game-style progress bare for pacman
  show_info "Enabling color and Pacman animation for pacman."
  sudo sed -i "s/^#Color$/Color/" ${pacmanconf}
  if ! test "$(grep ^ILoveCandy$ /etc/pacman.conf)"; then
    sudo sed -i "/^CheckSpace$/a ILoveCandy" ${pacmanconf}
  fi
}
